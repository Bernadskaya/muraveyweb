(function(a){a.fn.countdown=function(d,c){function b(f,g){return function(){return g.call(f)}}var e="seconds minutes hours days weeks daysLeft".split(" ");return this.each(function(){function h(){if(0===n.closest("html").length){clearInterval(m),o("removed")}else{p--;0>p&&(p=0);l={seconds:p%60,minutes:Math.floor(p/60)%60,hours:Math.floor(p/60/60)%24,days:Math.floor(p/60/60/24),weeks:Math.floor(p/60/60/24/7),daysLeft:Math.floor(p/60/60/24)%7};for(var g=0;g<e.length;g++){var f=e[g];k[f]!=l[f]&&(k[f]=l[f],o(f))}0==p&&(clearInterval(m),o("finished"))}}function o(g){var f=a.Event(g);f.date=new Date((new Date).valueOf()+p);f.value=k[g]||"0";f.toDate=d;f.lasting=l;switch(g){case"seconds":case"minutes":case"hours":f.value=10>f.value?"0"+f.value.toString():f.value.toString();break;default:f.value&&(f.value=f.value.toString())}c.call(n,f)}if(!(d instanceof Date)){if(String(d).match(/^[0-9]*$/)){d=new Date(d)}else{if(d.match(/([0-9]{1,2})\/([0-9]{1,2})\/([0-9]{2,4})\s([0-9]{1,2})\:([0-9]{2})\:([0-9]{2})/)||d.match(/([0-9]{2,4})\/([0-9]{1,2})\/([0-9]{1,2})\s([0-9]{1,2})\:([0-9]{2})\:([0-9]{2})/)){d=new Date(d)}else{if(d.match(/([0-9]{1,2})\/([0-9]{1,2})\/([0-9]{2,4})/)||d.match(/([0-9]{2,4})\/([0-9]{1,2})\/([0-9]{1,2})/)){d=new Date(d)}else{throw Error("Doesn't seen to be a valid date object or string")}}}}var n=a(this),k={},l={},m=n.data("countdownInterval"),p=Math.floor((d.valueOf()-(new Date).valueOf())/1000);h();m&&clearInterval(m);n.data("countdownInterval",setInterval(b(n,h),1000));m=n.data("countdownInterval")})}})(jQuery);